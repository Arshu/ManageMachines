<script>
    function flyLogin(progressElmId, responseElmId, loginUrlDivElmId, loginUrlElmId, successCallback) {

        var id = window.ajaxid++;
        var responseElm = getElm(responseElmId);
        //responseElm.textContent = '';
        //var responseContainerElmId = responseElmId + "Container";
        //hideElm(responseContainerElmId);
        var valid = true;

        if (valid === true) {

            let url = '/AppApi/FlyApi';
            let urlMethod = 'POST';
            let urlContent = {
                "jsonrpc": '2.0', "method": 'FlyLogin', "params": {
                }, "id": id
            };

            dopost(progressElmId, responseElmId, url, urlContent,
                function (data) {
                    if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                        else if (result.hasOwnProperty('message') === true) {
                            showText(responseElm, result.message, 'green');

                            if (result.hasOwnProperty('url') === true) {
                                getElm(loginUrlElmId).value = result.url;
                                showElm(loginUrlDivElmId);
                            }

                            if (typeof successCallback === "function") {
                                successCallback();
                            }
                        }
                    }
                    else if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var error = data.Error;
                        if (error.hasOwnProperty('Message') === true) {
                            showText(responseElm, error.Message, 'red');
                        }
                    }
                },
                function (data) {
                    if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var result = data.Error;
                        if (result.hasOwnProperty('Message') === true) {
                            showText(responseElm, result.Message, 'red');
                        }
                    }
                    else if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                    }
                });
        }

        return false;
    }

    function flyLogout(progressElmId, responseElmId, successCallback) {

        var id = window.ajaxid++;
        var responseElm = getElm(responseElmId);
        //responseElm.textContent = '';
        //var responseContainerElmId = responseElmId + "Container";
        //hideElm(responseContainerElmId);
        var valid = true;

        if (valid === true) {

            let url = '/AppApi/FlyApi';
            let urlMethod = 'POST';
            let urlContent = {
                "jsonrpc": '2.0', "method": 'FlyLogout', "params": {
                }, "id": id
            };

            dopost(progressElmId, responseElmId, url, urlContent,
                function (data) {
                    if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                        else if (result.hasOwnProperty('message') === true) {
                            showText(responseElm, result.message, 'green');

                            if (typeof successCallback === "function") {
                                successCallback();
                            }
                        }
                    }
                    else if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var error = data.Error;
                        if (error.hasOwnProperty('Message') === true) {
                            showText(responseElm, error.Message, 'red');
                        }
                    }
                },
                function (data) {
                    if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var result = data.Error;
                        if (result.hasOwnProperty('Message') === true) {
                            showText(responseElm, result.Message, 'red');
                        }
                    }
                    else if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                    }
                });
        }

        return false;
    }

    function flyRetrieveToken(progressElmId, responseElmId, targetElmId, successCallback) {

        var id = window.ajaxid++;
        var responseElm = getElm(responseElmId);
        //responseElm.textContent = '';
        //var responseContainerElmId = responseElmId + "Container";
        //hideElm(responseContainerElmId);
        var valid = true;

        if (valid === true) {

            let url = '/AppApi/FlyApi';
            let urlMethod = 'POST';
            let urlContent = {
                "jsonrpc": '2.0', "method": 'FlyRetrieveToken', "params": {
                }, "id": id
            };

            dopost(progressElmId, responseElmId, url, urlContent,
                function (data) {
                    if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                        if (result.hasOwnProperty('data') === true) {
                            getElm(targetElmId).value = result.data;
                        }
                        if (result.hasOwnProperty('message') === true) {
                            showText(responseElm, result.message, 'green');
                        }
                    }
                    else if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var error = data.Error;
                        if (error.hasOwnProperty('Message') === true) {
                            showText(responseElm, error.Message, 'red');
                        }
                    }
                },
                function (data) {
                    if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var result = data.Error;
                        if (result.hasOwnProperty('Message') === true) {
                            showText(responseElm, result.Message, 'red');
                        }
                    }
                    else if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                    }
                });
        }

        return false;
    }

    function flyRemoveToken(progressElmId, responseElmId, targetElmId, successCallback) {

        var id = window.ajaxid++;
        var responseElm = getElm(responseElmId);
        //responseElm.textContent = '';
        //var responseContainerElmId = responseElmId + "Container";
        //hideElm(responseContainerElmId);
        var valid = true;

        if (valid === true) {

            let url = '/AppApi/FlyApi';
            let urlMethod = 'POST';
            let urlContent = {
                "jsonrpc": '2.0', "method": 'FlyRemoveToken', "params": {
                }, "id": id
            };

            dopost(progressElmId, responseElmId, url, urlContent,
                function (data) {
                    if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                        if (result.hasOwnProperty('message') === true) {
                            showText(responseElm, result.message, 'green');
                            getElm(targetElmId).value = "";
                        }
                    }
                    else if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var error = data.Error;
                        if (error.hasOwnProperty('Message') === true) {
                            showText(responseElm, error.Message, 'red');
                        }
                    }
                },
                function (data) {
                    if ((data.hasOwnProperty('Error') === true) && (data.Error)) {
                        var result = data.Error;
                        if (result.hasOwnProperty('Message') === true) {
                            showText(responseElm, result.Message, 'red');
                        }
                    }
                    else if (data.hasOwnProperty('Result') === true) {
                        var result = data.Result;
                        if (result.hasOwnProperty('error') === true) {
                            showText(responseElm, result.error, 'red');
                        }
                    }
                });
        }

        return false;
    }

</script>
<div class="flex-content-wrap" id="flyLoginUrlDiv" style="margin: 5px 0px;display:none;">
    <div class="flex-item-stretch border-left" style="height: 40px;">
        <input style="width:100%;border:none;" id="flyLoginUrl" type="text" placeholder="Fly Login Url" />
    </div>
    <button class="border-right" style="width:100px;height:40px;background-color:lightgray;" onclick="window.open(getElm('flyLoginUrl').value, '_blank')">
        Open
    </button>
</div>

<div class="flex-content-wrap" style="margin: 5px 0px;">
    <button class="flex-item-stretch border" style="height: 40px; background-color: lightgray; margin:0px 5px 0 0"
            onclick=" triggerEvent('appInfoResetButton', 'click'); flyLogin('loginProgress', 'flyResponse', 'flyLoginUrlDiv', 'flyLoginUrl', function () { })">
        Login <div id="loginProgress"></div>
    </button>
    <button class="flex-item-stretch border" style="height: 40px; background-color: lightgray;"
            onclick=" triggerEvent('appInfoResetButton', 'click'); flyLogout('logoutProgress', 'flyResponse', function () { })">
        LogOut<div id="logoutProgress"></div>
    </button>
</div>

<div class="flex-content-wrap">
    <label style="width:100%;margin: 5px auto;">Fly Auth Token <span style="color: red; font-size: x-small;text-align:center;">(Access Token will be persisted. Please Remove Access Token after Use or Logout)</span></label>
    <button class="border-left" style="width:70px;height:40px;background-color:lightgray;"
            onclick=" triggerEvent('appInfoResetButton', 'click'); flyRetrieveToken('retrieveApiTokenProgress', 'flyResponse', 'flyAuthToken', function () { })">
        Retrieve
        <div id="retrieveApiTokenProgress"></div>
    </button>
    <div class="flex-item-stretch border-top-bottom" style="height: 40px;">
        <input style="width:100%;border:none;" id="flyAuthToken" type="password" placeholder="Fly Auth Token" value="{{$FlyAuthToken}}" onfocus="this.select();" />
    </div>
    <button class="border-right" style="width:70px;height:40px;background-color:lightgray;"
            onclick="triggerEvent('appInfoResetButton', 'click'); flyRemoveToken('removeApiTokenProgress', 'flyResponse', 'flyAuthToken', function () { })">
        Remove
        <div id="removeApiTokenProgress"></div>
    </button>
</div>
